<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新增供应商 - 供应商管理系统</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        success: '#00B42A',
                        warning: '#FF7D00',
                        danger: '#F53F3F',
                        gray: {
                            50: '#F9FAFB',
                            100: '#F2F3F5',
                            200: '#E5E6EB',
                            300: '#C9CDD4',
                            400: '#86909C',
                            500: '#4E5969',
                            600: '#1D2129',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            /* 基础样式 */
            .badge { @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium; }
            .badge-required { @apply bg-danger/10 text-danger; }
            
            /* 页面布局 */
            .page-container { @apply min-h-screen bg-gray-50 font-sans text-gray-600; }
            .content-wrapper { @apply container mx-auto px-4 py-6 max-w-7xl relative; } /* 新增：relative */

            /* 表单卡片 */
            .form-card { @apply bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden; }
            .form-header { @apply px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50; }
            .form-header-title { @apply text-lg font-semibold text-gray-600; }

            /* 表单分组 - 关键修改：基础信息模块padding-top:24px */
            .form-group { @apply mb-8 px-6 scroll-mt-20; } 
            #group-basic { @apply pt-6; } /* pt-6 对应24px，设置基础信息模块顶部内边距 */
            .form-group-title { @apply text-base font-medium text-gray-600 mb-4 flex items-center gap-2; }
            .form-group-title i { @apply text-primary; }

            /* 表单布局 */
            .form-grid { @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6; }
            .form-item { @apply col-span-1; }
            .form-item-full { @apply col-span-1 md:col-span-2 lg:col-span-3; }
            .form-item-row { @apply col-span-1 md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-6; }
            
            /* 行内表单布局 - 自适应宽度 */
            .inline-form-row { @apply flex flex-wrap gap-4 w-full; }
            .inline-form-item { @apply flex-1 min-w-[200px]; }
            
            /* 表单元素 */
            .form-label { @apply block text-sm font-medium text-gray-700 mb-1 flex items-center; }
            .form-label.required::after { content: '*'; @apply text-danger ml-1; }
            .form-input, .form-select, .form-textarea { @apply w-full px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-sm transition-all; }
            .form-input.error, .form-select.error, .form-textarea.error { @apply border-danger focus:ring-danger/20 focus:border-danger; }
            .form-error { @apply text-danger text-xs mt-1 flex items-center gap-1 hidden; }
            .form-error.show { @apply flex; }
            .form-hint { @apply text-gray-400 text-xs mt-1 flex items-center gap-1; }

            /* 按钮样式 */
            .form-btn { @apply px-6 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2; }
            .form-btn-primary { @apply bg-primary text-white hover:bg-primary/90; }
            .form-btn-primary i { @apply text-white; } /* 新增：主按钮图标白色 */
            .form-btn-default { @apply bg-white border border-gray-200 text-gray-600 hover:bg-gray-50; }
            .form-btn-sm { @apply px-3 py-1.5 text-xs; }
            .form-actions { @apply px-6 py-4 border-t border-gray-200 flex justify-end gap-3 bg-gray-50; }

            /* 复选框组 */
            .checkbox-group { @apply flex flex-wrap gap-4 mt-2 mb-1; }
            .checkbox-item { @apply flex items-center gap-2; }
            .checkbox-input { @apply w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary/20 cursor-pointer; }
            .checkbox-label { @apply text-sm text-gray-600 cursor-pointer; }

            /* 文件上传样式 */
            .upload-btn { @apply form-btn form-btn-default form-btn-sm py-1.5 px-4; }
            .upload-list { @apply mt-3; }
            .upload-item { @apply flex items-center gap-3 p-3 border border-gray-200 rounded mb-2; }
            .upload-icon { @apply text-xl text-primary; }
            .upload-info { @apply flex-1; }
            .upload-name { @apply text-sm font-medium; }
            .upload-meta { @apply text-xs text-gray-400; } /* 新增：文件元信息样式 */
            .upload-del { @apply text-gray-400 hover:text-danger text-sm p-1 rounded-full hover:bg-danger/5; }
            
            /* 资质文件卡片样式（重新设计） */
            .qualification-card { @apply border border-gray-200 rounded-md p-4 mb-4 hover:shadow-sm transition-shadow w-full; }
            .qualification-card-header { @apply flex justify-between items-center mb-4; }
            .qualification-card-title { @apply font-medium text-gray-700 text-base; }
            .qualification-card-actions { @apply flex gap-2; }
            
            /* 资质文件子项样式（重新设计，防止布局错乱） */
            .qualification-subitem { @apply border-t border-gray-100 pt-4 mt-4 first:border-t-0 first:pt-0 first:mt-0; }
            .qualification-subitem-title { @apply text-sm font-medium text-gray-700 mb-3; }
            .qualification-upload-row { @apply flex items-center gap-3 w-full flex-wrap; }
            .upload-btn-wrapper { @apply flex-shrink-0; }
            .qualification-file-info { @apply flex-1 min-w-[200px]; }
            .upload-del-wrapper { @apply flex-shrink-0; }
            
            /* 有效期区间样式 */
            .date-range-wrapper { @apply flex gap-3 w-full; }
            .date-range-item { @apply flex-1; }
            
            /* 加载状态样式 */
            .loading { @apply relative pointer-events-none; }
            .loading::before {
                content: '';
                @apply absolute inset-0 bg-white/80 rounded-md flex items-center justify-center;
            }
            .loading::after {
                content: '';
                @apply w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin;
            }
            
            /* 弹窗样式 */
            .modal-overlay { @apply fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden; }
            .modal-overlay.show { @apply flex; }
            .modal-container { @apply bg-white rounded-lg shadow-lg w-full max-w-lg mx-4; }
            .modal-header { @apply px-6 py-4 border-b border-gray-200 flex items-center justify-between; }
            .modal-title { @apply text-lg font-semibold text-gray-700; }
            .modal-close { @apply text-gray-400 hover:text-gray-600 cursor-pointer; }
            .modal-body { @apply px-6 py-4; }
            .modal-footer { @apply px-6 py-4 border-t border-gray-200 flex justify-end gap-3; }
            
            /* 表单导航样式 - 修复版 */
            .anchor-nav {
                @apply fixed right-4 lg:right-12 top-[148px] bg-white rounded-lg shadow-md border border-gray-200 p-3 z-40 hidden lg:block;
                width: 220px;
                max-height: calc(100vh - 180px);
                overflow-y: auto;
                /* 修复滚动条样式 */
                scrollbar-width: thin;
                scrollbar-color: #C9CDD4 #F2F3F5;
            }
            /* 自定义滚动条 */
            .anchor-nav::-webkit-scrollbar {
                @apply w-1.5;
            }
            .anchor-nav::-webkit-scrollbar-track {
                @apply bg-gray-100 rounded-full;
            }
            .anchor-nav::-webkit-scrollbar-thumb {
                @apply bg-gray-300 rounded-full hover:bg-gray-400;
            }
            .anchor-nav-title {
                @apply text-sm font-semibold text-gray-700 mb-3 pb-2 border-b border-gray-100 flex items-center justify-between;
            }
            .anchor-nav-progress {
                @apply text-xs text-primary font-medium;
            }
            .anchor-nav-list {
                @apply space-y-1;
            }
            .anchor-nav-item {
                @apply flex items-center justify-between py-1.5 px-2 rounded text-sm cursor-pointer transition-all hover:bg-primary/5;
            }
            .anchor-nav-item.active {
                @apply bg-primary/10 text-primary font-medium;
            }
            .anchor-nav-item-label {
                @apply flex-1 truncate;
            }
            .anchor-nav-item-status {
                @apply w-2 h-2 rounded-full ml-2;
            }
            .status-empty { @apply bg-gray-300; } /* 未开始 */
            .status-part { @apply bg-warning; }    /* 部分完成 */
            .status-complete { @apply bg-success; } /* 已完成 */
        }
    </style>
</head>
<body class="page-container">
 
    <!-- 右侧锚点导航 -->
    <div class="anchor-nav" id="anchorNav">
        <div class="anchor-nav-title">
            <span>表单导航</span>
            <span class="anchor-nav-progress" id="formProgress">0%</span>
        </div>
        <div class="anchor-nav-list" id="anchorNavList">
            <!-- 由JS动态生成 -->
        </div>
    </div>

    <!-- 主内容区 -->
    <main class="content-wrapper">
        <div class="form-card">
            <!-- 表单头部 -->
            <div class="form-header">
                <h2 class="form-header-title">新增供应商</h2>
            </div>

            <!-- 表单主体 -->
            <form id="supplierForm">
                <!-- 基础信息组 -->
                <div class="form-group" id="group-basic">
                    <div class="form-group-title">
                        <i class="fa-solid fa-id-card"></i>
                        基础信息
                    </div>
                    <div class="form-grid">
                        <!-- 供应商名称 -->
                        <div class="form-item">
                            <label class="form-label required">供应商名称</label>
                            <input type="text" class="form-input" id="supplierName" placeholder="请输入供应商全称">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商名称不能为空</div>
                        </div>
                        <!-- 供应商简称 -->
                        <div class="form-item">
                            <label class="form-label required">供应商简称</label>
                            <input type="text" class="form-input" id="supplierShortName" placeholder="请输入供应商简称">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商简称不能为空</div>
                        </div>
                        <!-- 供应商名称（英文） -->
                        <div class="form-item" id="englishNameItem">
                            <label class="form-label">供应商名称（英文）</label>
                            <input type="text" class="form-input" id="supplierEnglishName" placeholder="供应商类型为服务商时必填">
                            <div class="form-hint"><i class="fa-solid fa-circle-info"></i>仅服务商类型必填</div>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商英文名称不能为空</div>
                        </div>
                        <!-- 供应商归属类型 -->
                        <div class="form-item">
                            <label class="form-label required">供应商归属类型</label>
                            <select class="form-select" id="supplierBelongType">
                                <option value="">请选择归属类型</option>
                                <option value="0">0 外部单位</option>
                                <option value="1">1 内部单位</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商归属类型不能为空</div>
                        </div>
                        <!-- 供应商交易类型 -->
                        <div class="form-item">
                            <label class="form-label required">供应商交易类型</label>
                            <select class="form-select" id="supplierTradeType">
                                <option value="">请选择交易类型</option>
                                <option value="采购">采购</option>
                                <option value="服务">服务</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商交易类型不能为空</div>
                        </div>
                        <!-- 外付类型 -->
                        <div class="form-item">
                            <label class="form-label required">外付类型</label>
                            <select class="form-select" id="paymentType">
                                <option value="">请选择外付类型</option>
                                <option value="分包">分包</option>
                                <option value="分成">分成</option>
                                <option value="佣金">佣金</option>
                                <option value="采购">采购</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>外付类型不能为空</div>
                        </div>
                        <!-- 供应商分类 -->
                        <div class="form-item">
                            <label class="form-label required">供应商分类</label>
                            <select class="form-select" id="supplierCategory">
                                <option value="">请选择供应商分类</option>
                                <option value="中央企业">中央企业</option>
                                <option value="地方国企">地方国企</option>
                                <option value="中央部委">中央部委</option>
                                <option value="地方政府">地方政府</option>
                                <option value="民营企业">民营企业</option>
                                <option value="事业单位">事业单位</option>
                                <option value="个体工商户">个体工商户</option>
                                <option value="公共组织">公共组织</option>
                                <option value="外资企业">外资企业</option>
                                <option value="个人客商">个人客商</option>
                                <option value="虚拟客商">虚拟客商</option>
                                <option value="其他">其他</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商分类不能为空</div>
                        </div>
                        <!-- 信用代码类型 -->
                        <div class="form-item">
                            <label class="form-label required">信用代码类型</label>
                            <select class="form-select" id="creditCodeType">
                                <option value="">请选择信用代码类型</option>
                                <option value="01">01 统一社会信用代码</option>
                                <option value="02">02 公民身份证代码</option>
                                <option value="09">09 其他</option>
                                <option value="10">10 护照</option>
                                <option value="04">04 对白编码</option>
                                <option value="08">08 系统生成代码</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>信用代码类型不能为空</div>
                        </div>
                        <!-- 信用代码 -->
                        <div class="form-item">
                            <label class="form-label required">信用代码</label>
                            <input type="text" class="form-input" id="creditCode" placeholder="请输入对应类型的信用代码">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>信用代码不能为空</div>
                            <div class="form-error" id="creditCodeFormatError"><i class="fa-solid fa-circle-exclamation"></i>统一社会信用代码必须为18位</div>
                        </div>
                        <!-- 法定代表人 -->
                        <div class="form-item">
                            <label class="form-label required">法定代表人</label>
                            <input type="text" class="form-input" id="legalPerson" placeholder="请输入法定代表人姓名">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>法定代表人不能为空</div>
                        </div>
                        <!-- 注册资本 -->
                        <div class="form-item">
                            <label class="form-label required">注册资本（万元）</label>
                            <input type="number" class="form-input" id="registeredCapital" placeholder="请输入注册资本金额" min="0" step="0.01">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>注册资本不能为空</div>
                        </div>
                        <!-- 注册币种 -->
                        <div class="form-item">
                            <label class="form-label required">注册币种</label>
                            <select class="form-select" id="registeredCurrency">
                                <option value="">请选择注册币种</option>
                                <option value="人民币">人民币</option>
                                <option value="美元">美元</option>
                                <option value="欧元">欧元</option>
                                <option value="港币">港币</option>
                                <option value="其他">其他</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>注册币种不能为空</div>
                        </div>
                        <!-- 注册成立单位 -->
                        <div class="form-item">
                            <label class="form-label required">注册成立单位</label>
                            <input type="text" class="form-input" id="registeredUnit" placeholder="请输入批准成立的主管单位">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>注册成立单位不能为空</div>
                        </div>
                        <!-- 成立时间 -->
                        <div class="form-item">
                            <label class="form-label required">成立时间</label>
                            <input type="date" class="form-input" id="establishmentDate">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>成立时间不能为空</div>
                        </div>
                        <!-- 供应商有效期 -->
                        <div class="form-item">
                            <label class="form-label required">供应商有效期</label>
                            <select class="form-select" id="validityPeriod">
                                <option value="">请选择有效期</option>
                                <option value="1">1年</option>
                                <option value="2">2年</option>
                                <option value="3">3年</option>
                        
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>供应商有效期不能为空</div>
                        </div>
                        <!-- 风险等级字段 -->
                        <div class="form-item">
                            <label class="form-label required">风险等级</label>
                            <select class="form-select" id="riskLevel">
                                <option value="">请选择风险等级</option>
                                <option value="0">0 无风险</option>
                                <option value="1">1 低风险</option>
                                <option value="2">2 中风险</option>
                                <option value="3">3 高风险</option>
                            </select>
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>风险等级不能为空</div>
                        </div>
                    </div>
                </div>

                <!-- 国家名称模块 -->
                <div class="form-group" id="group-region">
                    <div class="form-group-title">
                        <i class="fa-solid fa-globe"></i>
                        国家/地区信息
                    </div>
                    <div class="form-grid">
                        <div class="form-item-full">
                            <!-- 区域类型、国家/地区、时区、主要业务语言 - 一行显示 -->
                            <div class="inline-form-row">
                                <!-- 区域类型 -->
                                <div class="inline-form-item">
                                    <label class="form-label required">区域类型</label>
                                    <select class="form-select" id="regionType">
                                        <option value="domestic" selected>国内</option>
                                        <option value="foreign">国外</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>区域类型不能为空</div>
                                </div>
                                
                                <!-- 国家/地区 -->
                                <div class="inline-form-item">
                                    <label class="form-label required">国家/地区</label>
                                    <select class="form-select" id="countryRegion">
                                        <option value="">请选择国家/地区</option>
                                        <option value="中国大陆" selected>中国大陆</option>
                                        <option value="中国香港">中国香港</option>
                                        <option value="中国澳门">中国澳门</option>
                                        <option value="中国台湾">中国台湾</option>
                                        <option value="美国">美国</option>
                                        <option value="英国">英国</option>
                                        <option value="日本">日本</option>
                                        <option value="德国">德国</option>
                                        <option value="法国">法国</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>国家/地区不能为空</div>
                                </div>
                                
                                <!-- 时区 -->
                                <div class="inline-form-item">
                                    <label class="form-label required">时区</label>
                                    <select class="form-select" id="timezone">
                                        <option value="">请选择时区</option>
                                        <option value="UTC+8" selected>北京时间(UTC+08)</option>
                                        <option value="UTC-5">纽约时间(UTC-05)</option>
                                        <option value="UTC+0">伦敦时间(UTC+00)</option>
                                        <option value="UTC+9">东京时间(UTC+09)</option>
                                        <option value="UTC+1">柏林时间(UTC+01)</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>时区不能为空</div>
                                </div>
                                
                                <!-- 主要业务语言 -->
                                <div class="inline-form-item">
                                    <label class="form-label required">主要业务语言</label>
                                    <select class="form-select" id="businessLanguage">
                                        <option value="">请选择主要业务语言</option>
                                        <option value="中文" selected>中文简体</option>
                                        <option value="英文">英文</option>
                                        <option value="日文">日文</option>
                                        <option value="繁体中文">繁体中文</option>
                                        <option value="德文">德文</option>
                                        <option value="法文">法文</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>主要业务语言不能为空</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 供应商业务类型 -->
                <div class="form-group" id="group-business-type">
                    <div class="form-group-title">
                        <i class="fa-solid fa-briefcase"></i>
                        供应商业务类型
                    </div>
                    <div class="form-item-full">
                        <label class="form-label required">业务类型（可多选）</label>
                        <div class="checkbox-group" id="businessTypeGroup">
                            <div class="checkbox-item">
                                <input type="checkbox" id="type1" class="checkbox-input business-type" value="服务提供商">
                                <label for="type1" class="checkbox-label">服务提供商</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="type2" class="checkbox-input business-type" value="分包方">
                                <label for="type2" class="checkbox-label">分包方</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="type3" class="checkbox-input business-type" value="物资供应商">
                                <label for="type3" class="checkbox-label">物资供应商</label>
                            </div>
                        </div>
                        <div class="form-error" id="businessTypeError"><i class="fa-solid fa-circle-exclamation"></i>至少选择一种业务类型</div>
                    </div>
                </div>

                <!-- 资质文件上传模块（重新设计） -->
                <div class="form-group" id="group-files">
                    <div class="form-group-title">
                        <i class="fa-solid fa-file-upload"></i>
                        资质文件上传
                    </div>
                    
                    <!-- 资质文件列表容器（卡片式展示） -->
                    <div id="qualificationList" class="mt-4">
                        <!-- 初始无文件状态 -->
                        <div id="emptyQualification" class="text-center py-8 text-gray-400">
                            <i class="fa-solid fa-file-alt text-4xl mb-2"></i>
                            <p>暂无上传的资质文件，请先选择业务类型</p>
                        </div>
                    </div>
                </div>

                <!-- 地址信息 -->
                <div class="form-group" id="group-address">
                    <div class="form-group-title">
                        <i class="fa-solid fa-map-marker-alt"></i>
                        地址信息
                    </div>
                    <div class="form-grid">
                        <!-- 省市区（仅国内显示） -->
                        <div id="addressRegionWrapper" class="form-item-full">
                            <!-- 省、市、区县 - 一行显示 -->
                            <div class="inline-form-row">
                                <!-- 省、直辖市 -->
                                <div class="inline-form-item" id="provinceItem">
                                    <label class="form-label required">省/直辖市</label>
                                    <select class="form-select" id="province">
                                        <option value="">请选择省/直辖市</option>
                                        <option value="北京市">北京市</option>
                                        <option value="上海市">上海市</option>
                                        <option value="广东省">广东省</option>
                                        <option value="江苏省">江苏省</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>省/直辖市不能为空</div>
                                </div>
                                <!-- 市（省级） -->
                                <div class="inline-form-item" id="cityItem">
                                    <label class="form-label required">市</label>
                                    <select class="form-select" id="city">
                                        <option value="">请先选择省/直辖市</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>市不能为空</div>
                                </div>
                                <!-- 区县 -->
                                <div class="inline-form-item" id="districtItem">
                                    <label class="form-label required">区县</label>
                                    <select class="form-select" id="district">
                                        <option value="">请先选择市</option>
                                    </select>
                                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>区县不能为空</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 注册地址（国内） -->
                        <div class="form-item-full" id="registerAddressItem">
                            <label class="form-label required">注册地址</label>
                            <input type="text" class="form-input" id="registerAddress" placeholder="请输入详细注册地址">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>注册地址不能为空</div>
                        </div>
                        
                        <!-- 注册地址（英文/国外） -->
                        <div class="form-item-full" id="registerAddressEnItem" style="display: none;">
                            <label class="form-label required">注册地址（英文）</label>
                            <input type="text" class="form-input" id="registerAddressEn" placeholder="请输入英文注册地址">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>注册地址（英文）不能为空</div>
                        </div>
                    </div>
                </div>

                <!-- 新增：经营范围模块（选填） -->
                <div class="form-group" id="group-business-scope">
                    <div class="form-group-title">
                        <i class="fa-solid fa-list-check"></i>
                        经营范围
                    </div>
                    <div class="form-grid">
                        <div class="form-item-full">
                            <label class="form-label">经营范围</label>
                            <textarea class="form-textarea" id="businessScope" rows="4" placeholder="请输入供应商的经营范围（选填）"></textarea>
                            <div class="form-hint"><i class="fa-solid fa-circle-info"></i>选填，建议详细描述供应商的主营业务范围</div>
                        </div>
                    </div>
                </div>

                <!-- 新增：供应商合格评定信息模块（选填） -->
                <div class="form-group" id="group-evaluation">
                    <div class="form-group-title">
                        <i class="fa-solid fa-clipboard-check"></i>
                        供应商合格评定信息
                    </div>
                    
                        <div class="form-item-full">
                            <label class="form-label">评定备注</label>
                            <textarea class="form-textarea" id="evaluationRemark" rows="3" placeholder="请输入评定相关备注信息（选填）"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 表单操作按钮 -->
                <div class="form-actions">
                    <button type="button" class="form-btn form-btn-default">
                        <i class="fa-solid fa-arrow-left"></i> 返回列表
                    </button>
                    <button type="button" class="form-btn form-btn-default">
                        <i class="fa-solid fa-save"></i> 保存草稿
                    </button>
                    <button type="submit" class="form-btn form-btn-primary">
                        <i class="fa-solid fa-check"></i> 提交审核
                    </button>
                </div>
            </form>
        </div>
    </main>

    <!-- 资质文件上传弹窗（重新设计，支持时间区间选择） -->
    <div class="modal-overlay" id="qualificationModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">上传文件</h3>
                <i class="fa-solid fa-xmark modal-close" id="modalClose"></i>
            </div>
            <div class="modal-body">
                <!-- 隐藏的文件类型标识 -->
                <input type="hidden" id="uploadFileType" value="">
                
                <div class="form-item">
                    <label class="form-label required">上传文件</label>
                    <input type="file" class="form-input" id="fileUpload" accept=".pdf,.jpg,.jpeg,.png">
                    <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>请选择要上传的文件</div>
                    <div class="form-hint"><i class="fa-solid fa-circle-info"></i>支持PDF、JPG、PNG格式，单个文件不超过10MB</div>
                </div>
                
                <!-- 有效期时间区间（重新设计） -->
                <div class="form-item" id="dateRangeWrapper" style="display: none;">
                    <label class="form-label required">有效期区间</label>
                    <div class="date-range-wrapper">
                        <div class="date-range-item">
                            <label class="form-label">开始日期</label>
                            <input type="date" class="form-input" id="startDate">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>开始日期不能为空</div>
                        </div>
                        <div class="date-range-item">
                            <label class="form-label">结束日期</label>
                            <input type="date" class="form-input" id="endDate">
                            <div class="form-error"><i class="fa-solid fa-circle-exclamation"></i>结束日期不能为空</div>
                        </div>
                    </div>
                    <div class="form-error" id="dateRangeError" style="display: none;"><i class="fa-solid fa-circle-exclamation"></i>结束日期不能早于开始日期</div>
                </div>
                
                <div class="form-item">
                    <label class="form-label">备注说明</label>
                    <textarea class="form-textarea" id="fileRemark" rows="3" placeholder="请输入文件备注信息（选填）"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="form-btn form-btn-default" id="cancelUpload">取消</button>
                <button type="button" class="form-btn form-btn-primary" id="confirmUpload">确认上传</button>
            </div>
        </div>
    </div>

    <script>
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 1. 定义所有业务类型对应的资质卡片配置
            const qualificationCardConfigs = {
                // 服务提供商卡片配置
                '服务提供商': [
                    {
                        id: 'card-license',
                        title: '资质审核文件',
                        subItems: [
                            { id: 'sub-license', name: '营业执照', hasDateRange: true },
                            { id: 'sub-permit', name: '经营许可证明', hasDateRange: false }
                        ]
                    },
                    {
                        id: 'card-tax',
                        title: '纳税社保证明（三月内任一纳税和社保证明）',
                        subItems: [
                            { id: 'sub-tax', name: '纳税证明', hasDateRange: false },
                            { id: 'sub-social', name: '社保证明', hasDateRange: false }
                        ]
                    }
                ],
                // 分包方卡片配置
                '分包方': [
                    {
                        id: 'card-license', // 复用ID，避免重复显示
                        title: '资质审核文件',
                        subItems: [
                            { id: 'sub-license', name: '营业执照', hasDateRange: true },
                            { id: 'sub-permit', name: '经营许可证明', hasDateRange: false }
                        ]
                    },
                    {
                        id: 'card-tax', // 复用ID，避免重复显示
                        title: '纳税社保证明（三月内任一纳税和社保证明）',
                        subItems: [
                            { id: 'sub-tax', name: '纳税证明', hasDateRange: false },
                            { id: 'sub-social', name: '社保证明', hasDateRange: false }
                        ]
                    },
                    {
                        id: 'card-capital',
                        title: '实缴资本证明（工商登记或天眼查或股东资金转入公账凭证）',
                        subItems: [
                            { id: 'sub-capital-1', name: '工商登记', hasDateRange: false },
                            { id: 'sub-capital-2', name: '天眼查', hasDateRange: false },
                            { id: 'sub-capital-3', name: '股东资金转入公账凭证', hasDateRange: false }
                        ]
                    },
                    {
                        id: 'card-cert',
                        title: '资质证书文件（CNAS认可、CMA计量资质认定、CATL资质认定、CPSC授权认可）',
                        subItems: [
                            { id: 'sub-cert-1', name: 'CNAS认可', hasDateRange: true },
                            { id: 'sub-cert-2', name: 'CMA计量资质认定', hasDateRange: true },
                            { id: 'sub-cert-3', name: 'CATL资质认定', hasDateRange: true },
                            { id: 'sub-cert-4', name: 'CPSC授权认可', hasDateRange: true }
                        ]
                    }
                ]
            };

            // 2. 监听业务类型选择变化
            const businessTypeCheckboxes = document.querySelectorAll('.business-type');
            const qualificationList = document.getElementById('qualificationList');
            const emptyQualification = document.getElementById('emptyQualification');

            // 业务类型选择变化处理函数
            function handleBusinessTypeChange() {
                // 获取所有选中的业务类型
                const selectedTypes = Array.from(businessTypeCheckboxes)
                    .filter(checkbox => checkbox.checked)
                    .map(checkbox => checkbox.value);

                if (selectedTypes.length === 0) {
                    // 未选择任何业务类型：清空所有卡片，显示空状态
                    clearAllQualificationCards();
                    emptyQualification.style.display = 'block';
                    return;
                }

                // 隐藏空状态
                emptyQualification.style.display = 'none';

                // 收集所有需要显示的卡片配置（去重）
                const cardsToShow = {};
                selectedTypes.forEach(type => {
                    if (qualificationCardConfigs[type]) {
                        qualificationCardConfigs[type].forEach(cardConfig => {
                            // 用卡片ID作为key，自动去重
                            cardsToShow[cardConfig.id] = cardConfig;
                        });
                    }
                });

                // 先移除已存在但不需要显示的卡片
                document.querySelectorAll('.qualification-card').forEach(card => {
                    if (!cardsToShow[card.id]) {
                        card.remove();
                    }
                });

                // 创建或更新需要显示的卡片
                Object.values(cardsToShow).forEach(cardConfig => {
                    if (!document.getElementById(cardConfig.id)) {
                        createQualificationCard(cardConfig);
                    }
                });
            }

            // 清空所有资质卡片
            function clearAllQualificationCards() {
                document.querySelectorAll('.qualification-card').forEach(card => {
                    card.remove();
                });
            }

            // 创建资质文件卡片
            function createQualificationCard(cardConfig) {
                const card = document.createElement('div');
                card.id = cardConfig.id;
                card.className = 'qualification-card';
                
                // 卡片头部
                let cardHTML = `
                    <div class="qualification-card-header">
                        <h4 class="qualification-card-title">${cardConfig.title}</h4>
                        <div class="qualification-card-actions">
                            <button type="button" class="form-btn form-btn-primary form-btn-sm add-file-btn">
                                <i class="fa-solid fa-plus"></i> 添加文件
                            </button>
                        </div>
                    </div>
                `;
                
                // 添加子上传项
                cardConfig.subItems.forEach(subItem => {
                    cardHTML += `
                        <div class="qualification-subitem" id="${subItem.id}">
                            <div class="qualification-subitem-title">${subItem.name}</div>
                            <div class="qualification-upload-row">
                                <div class="upload-btn-wrapper">
                                    <button type="button" class="form-btn form-btn-default form-btn-sm upload-btn upload-subitem-btn" 
                                            data-subitem="${subItem.id}" 
                                            data-name="${subItem.name}" 
                                            data-daterange="${subItem.hasDateRange}">
                                        <i class="fa-solid fa-upload"></i> 上传文件
                                    </button>
                                </div>
                                <div class="qualification-file-info">
                                    <div class="upload-name text-gray-400">未上传</div>
                                    <div class="upload-meta text-xs text-gray-400">--</div> <!-- 修改：使用新的类名 -->
                                </div>
                                <div class="upload-del-wrapper">
                                    <button type="button" class="form-btn form-btn-default form-btn-sm upload-del" style="display:none">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                card.innerHTML = cardHTML;
                
                // 将卡片添加到列表中
                qualificationList.appendChild(card);
                
                // 为上传按钮添加事件监听
                card.querySelectorAll('.upload-subitem-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const subItemId = this.dataset.subitem;
                        const subItemName = this.dataset.name;
                        const hasDateRange = this.dataset.daterange === 'true';
                        
                        // 设置弹窗标题和参数
                        document.getElementById('modalTitle').textContent = `上传${subItemName}`;
                        document.getElementById('uploadFileType').value = subItemId;
                        
                        // 显示/隐藏有效期区间字段
                        const dateRangeWrapper = document.getElementById('dateRangeWrapper');
                        if (hasDateRange) {
                            dateRangeWrapper.style.display = 'block';
                        } else {
                            dateRangeWrapper.style.display = 'none';
                        }
                        
                        // 打开弹窗
                        document.getElementById('qualificationModal').classList.add('show');
                    });
                });
                
                // 为添加文件按钮添加事件监听
                card.querySelector('.add-file-btn').addEventListener('click', function() {
                    document.getElementById('modalTitle').textContent = '添加其他文件';
                    document.getElementById('uploadFileType').value = 'other';
                    document.getElementById('dateRangeWrapper').style.display = 'none';
                    document.getElementById('qualificationModal').classList.add('show');
                });
            }

            // 为每个业务类型复选框添加监听
            businessTypeCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', handleBusinessTypeChange);
            });

            // 3. 资质文件上传弹窗相关逻辑
            const qualificationModal = document.getElementById('qualificationModal');
            const modalClose = document.getElementById('modalClose');
            const cancelUpload = document.getElementById('cancelUpload');
            const confirmUpload = document.getElementById('confirmUpload');
            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');
            const dateRangeError = document.getElementById('dateRangeError');

            // 关闭弹窗
            function closeModal() {
                qualificationModal.classList.remove('show');
                // 清空表单
                document.getElementById('fileUpload').value = '';
                document.getElementById('fileRemark').value = '';
                document.getElementById('startDate').value = '';
                document.getElementById('endDate').value = '';
                document.getElementById('uploadFileType').value = '';
                document.getElementById('dateRangeWrapper').style.display = 'none';
                dateRangeError.style.display = 'none';
            }

            modalClose.addEventListener('click', closeModal);
            cancelUpload.addEventListener('click', closeModal);

            // 点击弹窗外层关闭
            qualificationModal.addEventListener('click', function(e) {
                if (e.target === qualificationModal) {
                    closeModal();
                }
            });

            // 验证日期区间
            function validateDateRange() {
                const startDate = startDateInput.value;
                const endDate = endDateInput.value;
                
                if (startDate && endDate) {
                    if (new Date(endDate) < new Date(startDate)) {
                        dateRangeError.style.display = 'flex';
                        return false;
                    } else {
                        dateRangeError.style.display = 'none';
                        return true;
                    }
                }
                return true;
            }

            // 监听日期变化
            startDateInput.addEventListener('change', validateDateRange);
            endDateInput.addEventListener('change', validateDateRange);

            // 确认上传
            confirmUpload.addEventListener('click', function() {
                // 获取上传参数
                const fileType = document.getElementById('uploadFileType').value;
                const fileUpload = document.getElementById('fileUpload').files[0];
                const hasDateRange = fileType.includes('sub-license') || fileType.startsWith('sub-cert-');
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                
                // 验证文件选择
                if (!fileUpload) {
                    alert('请选择要上传的文件');
                    return;
                }
                
                // 验证日期区间（如果需要）
                if (hasDateRange) {
                    if (!startDate) {
                        alert('请选择开始日期');
                        return;
                    }
                    if (!endDate) {
                        alert('请选择结束日期');
                        return;
                    }
                    if (!validateDateRange()) {
                        alert('结束日期不能早于开始日期');
                        return;
                    }
                }

                // 模拟上传成功
                alert('文件上传成功！');
                
                // 更新对应文件信息
                const subItemElement = document.getElementById(fileType);
                if (subItemElement) {
                    const fileInfo = subItemElement.querySelector('.qualification-file-info');
                    const delBtn = subItemElement.querySelector('.upload-del');
                    
                    // 更新文件信息
                    const now = new Date();
                    const formattedUploadTime = `${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                    
                    // 文件名称和上传时间
                    fileInfo.querySelector('.upload-name').textContent = `${fileUpload.name}`;
                    fileInfo.querySelector('.upload-name').className = 'upload-name';
                    
                    // 构建元信息（文件大小 + 上传日期 + 有效期）
                    let metaInfo = `文件大小：${formatFileSize(fileUpload.size)} | 上传日期：${formattedUploadTime}`;
                    
                    // 如果有有效期，添加有效期信息
                    if (hasDateRange && startDate && endDate) {
                        // 格式化有效期日期
                        const formattedStartDate = startDate.replace(/-/g, '/');
                        const formattedEndDate = endDate.replace(/-/g, '/');
                        metaInfo += ` | 有效期：${formattedStartDate} 至 ${formattedEndDate}`;
                    }
                    
                    // 更新元信息
                    fileInfo.querySelector('.upload-meta').textContent = metaInfo;
                    
                    // 显示删除按钮
                    delBtn.style.display = 'block';
                    
                    // 删除按钮事件
                    delBtn.addEventListener('click', function() {
                        // 重置文件信息
                        fileInfo.querySelector('.upload-name').textContent = '未上传';
                        fileInfo.querySelector('.upload-name').className = 'upload-name text-gray-400';
                        fileInfo.querySelector('.upload-meta').textContent = '--';
                        
                        // 隐藏删除按钮
                        this.style.display = 'none';
                    });
                }
                
                closeModal();
            });

            // 格式化文件大小
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            // 4. 省市区联动示例
            const provinceSelect = document.getElementById('province');
            const citySelect = document.getElementById('city');
            const districtSelect = document.getElementById('district');

            // 模拟省市区数据
            const regionData = {
                '北京市': {
                    '北京市': ['东城区', '西城区', '朝阳区', '海淀区', '丰台区']
                },
                '上海市': {
                    '上海市': ['黄浦区', '徐汇区', '长宁区', '静安区', '普陀区']
                },
                '广东省': {
                    '广州市': ['天河区', '越秀区', '海珠区', '荔湾区', '白云区'],
                    '深圳市': ['福田区', '南山区', '宝安区', '龙岗区', '罗湖区']
                },
                '江苏省': {
                    '南京市': ['玄武区', '秦淮区', '鼓楼区', '建邺区', '栖霞区'],
                    '苏州市': ['姑苏区', '吴中区', '相城区', '虎丘区', '吴江区']
                }
            };

            // 省份变化监听
            provinceSelect.addEventListener('change', function() {
                const province = this.value;
                // 清空市和区县
                citySelect.innerHTML = '<option value="">请先选择省/直辖市</option>';
                districtSelect.innerHTML = '<option value="">请先选择市</option>';

                if (province && regionData[province]) {
                    // 添加城市选项
                    Object.keys(regionData[province]).forEach(city => {
                        const option = document.createElement('option');
                        option.value = city;
                        option.textContent = city;
                        citySelect.appendChild(option);
                    });
                }
            });

            // 城市变化监听
            citySelect.addEventListener('change', function() {
                const province = provinceSelect.value;
                const city = this.value;
                // 清空区县
                districtSelect.innerHTML = '<option value="">请先选择市</option>';

                if (province && city && regionData[province] && regionData[province][city]) {
                    // 添加区县选项
                    regionData[province][city].forEach(district => {
                        const option = document.createElement('option');
                        option.value = district;
                        option.textContent = district;
                        districtSelect.appendChild(option);
                    });
                }
            });

            // 5. 区域类型切换（国内/国外）
            const regionTypeSelect = document.getElementById('regionType');
            const addressRegionWrapper = document.getElementById('addressRegionWrapper');
            const registerAddressItem = document.getElementById('registerAddressItem');
            const registerAddressEnItem = document.getElementById('registerAddressEnItem');

            regionTypeSelect.addEventListener('change', function() {
                if (this.value === 'domestic') {
                    // 国内：显示省市区和中文地址
                    addressRegionWrapper.style.display = 'block';
                    registerAddressItem.style.display = 'block';
                    registerAddressEnItem.style.display = 'none';
                } else {
                    // 国外：隐藏省市区，显示英文地址
                    addressRegionWrapper.style.display = 'none';
                    registerAddressItem.style.display = 'none';
                    registerAddressEnItem.style.display = 'block';
                }
            });

            // 6. 修复表单导航功能 - 动态生成导航项并实现滚动监听
            function initAnchorNav() {
                // 获取所有表单分组
                const formGroups = document.querySelectorAll('.form-group');
                const anchorNavList = document.getElementById('anchorNavList');
                const formProgress = document.getElementById('formProgress');
                
                // 清空现有导航项
                anchorNavList.innerHTML = '';
                
                // 为每个分组创建导航项
                formGroups.forEach(group => {
                    const groupId = group.id;
                    const groupTitle = group.querySelector('.form-group-title').textContent.trim();
                    const icon = group.querySelector('.form-group-title i').outerHTML;
                    
                    const navItem = document.createElement('div');
                    navItem.className = 'anchor-nav-item';
                    navItem.dataset.target = groupId;
                    navItem.innerHTML = `
                        <span class="anchor-nav-item-label">${icon} ${groupTitle}</span>
                        <span class="anchor-nav-item-status status-empty"></span>
                    `;
                    
                    // 点击导航项滚动到对应位置
                    navItem.addEventListener('click', function() {
                        const target = document.getElementById(this.dataset.target);
                        if (target) {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    });
                    
                    anchorNavList.appendChild(navItem);
                });
                
                // 监听滚动事件，更新导航状态
                window.addEventListener('scroll', function() {
                    const scrollPosition = window.scrollY + 200;
                    const totalHeight = document.body.scrollHeight - window.innerHeight;
                    const progress = Math.round((scrollPosition / totalHeight) * 100);
                    
                    // 更新进度百分比
                    formProgress.textContent = `${Math.min(progress, 100)}%`;
                    
                    // 更新当前激活的导航项
                    formGroups.forEach((group, index) => {
                        const groupTop = group.offsetTop;
                        const groupBottom = groupTop + group.offsetHeight;
                        const navItems = anchorNavList.querySelectorAll('.anchor-nav-item');
                        const navItem = navItems[index];
                        const statusDot = navItem.querySelector('.anchor-nav-item-status');
                        
                        // 判断当前分组是否在可视区域
                        if (scrollPosition >= groupTop && scrollPosition < groupBottom) {
                            // 激活当前项
                            navItems.forEach(item => item.classList.remove('active'));
                            navItem.classList.add('active');
                            statusDot.className = 'anchor-nav-item-status status-part';
                        } else if (scrollPosition > groupBottom) {
                            // 已完成
                            statusDot.className = 'anchor-nav-item-status status-complete';
                        } else {
                            // 未开始
                            if (!navItem.classList.contains('active')) {
                                statusDot.className = 'anchor-nav-item-status status-empty';
                            }
                        }
                    });
                });
                
                // 初始触发一次滚动事件
                window.dispatchEvent(new Event('scroll'));
            }
            
            // 初始化表单导航
            initAnchorNav();
        });
    </script>
</body>
</html>
